Migration propre vers OpenStreetMap (source de vÃ©ritÃ©)

Objectif :
Faire dâ€™OpenStreetMap (OSM) la source principale et fiable des donnÃ©es de lieux (pharmacies, stations-service, restaurants, marchÃ©s, boutiques) dans BurkinaWatch, tout en conservant Google Maps uniquement pour lâ€™itinÃ©raire.

1ï¸âƒ£ Clarifier les rÃ´les des services cartographiques

OpenStreetMap (Overpass API) :

Source officielle des donnÃ©es de lieux

RÃ©cupÃ©ration : nom, type, coordonnÃ©es GPS, adresse

Leaflet :

Affichage des cartes

Google Maps :

Navigation uniquement (ouvrir lâ€™itinÃ©raire externe)

Aucune donnÃ©e Google ne doit Ãªtre stockÃ©e en base

Mapillary :

Contexte visuel terrain (street view citoyen)

2ï¸âƒ£ Base de donnÃ©es â€” adaptation sans casse

Dans PostgreSQL (Drizzle ORM), ajouter ou complÃ©ter les champs suivants pour chaque lieu :

source (enum : 'OSM', 'COMMUNAUTE', 'OFFICIEL')

confidence_score (float, par dÃ©faut 0.5)

verified (boolean)

last_updated (timestamp)

Aucune suppression de donnÃ©es existantes.
Les nouvelles donnÃ©es doivent progressivement remplacer les anciennes.

3ï¸âƒ£ RÃ©cupÃ©ration des lieux via OpenStreetMap

CrÃ©er un service backend services/osmService.ts :

Utiliser Overpass API

RequÃªter par :

type de lieu (pharmacy, fuel, restaurant, marketplace, shop)

zone administrative (Burkina Faso / rÃ©gions)

Mapper les rÃ©sultats vers le modÃ¨le interne de BurkinaWatch

Marquer toutes les entrÃ©es comme :

source = 'OSM'

confidence_score = 0.6

4ï¸âƒ£ Migration progressive des donnÃ©es existantes

Pour chaque lieu existant :

Comparer coordonnÃ©es / nom avec OSM

Si correspondance trouvÃ©e :

Mettre Ã  jour les infos depuis OSM

Augmenter confidence_score

Sinon :

Conserver lâ€™entrÃ©e avec statut â€œÃ€ vÃ©rifierâ€

Aucune interruption du service pendant la migration.

5ï¸âƒ£ Interface utilisateur â€” transparence & confiance

Sur chaque fiche de lieu :

Afficher :

Badge source : OSM / Officiel / CommunautÃ©

Badge Ã©tat : VÃ©rifiÃ© / Ã€ vÃ©rifier

Ajouter deux actions :

â€œConfirmer lâ€™informationâ€

â€œSignaler une erreurâ€

RÃ¨gles :

3 confirmations â†’ verified = true, confidence_score â‰¥ 0.8

2 signalements â†’ verified = false, statut â€œÃ€ vÃ©rifierâ€

6ï¸âƒ£ Google Maps â€” usage autorisÃ© uniquement

Supprimer toute rÃ©cupÃ©ration de donnÃ©es depuis Google Maps API

Conserver uniquement :

Bouton â€œSâ€™y rendreâ€

Lien externe vers Google Maps avec coordonnÃ©es GPS

Aucune donnÃ©e Google ne doit Ãªtre stockÃ©e, ni analysÃ©e, ni modifiÃ©e.

7ï¸âƒ£ Mode offline & cache

Les donnÃ©es OSM rÃ©cupÃ©rÃ©es doivent Ãªtre :

stockÃ©es en base

synchronisÃ©es avec IndexedDB (TanStack Query)

Lâ€™application doit fonctionner mÃªme sans connexion

8ï¸âƒ£ QualitÃ©, sÃ©curitÃ© et conformitÃ©

Logger les erreurs Overpass API

ImplÃ©menter un fallback sur les donnÃ©es existantes

Documenter la politique de donnÃ©es cartographiques

Ne jamais exposer les clÃ©s API cÃ´tÃ© client

ğŸ¯ RÃ©sultat attendu

DonnÃ©es plus fiables et vÃ©rifiables

ZÃ©ro dÃ©pendance critique Ã  Google

Respect des conditions lÃ©gales

CrÃ©dibilitÃ© renforcÃ©e pour un usage institutionnel

Aucune rÃ©gression fonctionnelle

ImplÃ©mente cette migration proprement, sans casser lâ€™existant, avec un code clair, commentÃ© et Ã©volutif.